<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ganader√≠a Offline</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">üêÑ</div>
      <div>
        <div class="title">Ganader√≠a Offline</div>
        <div class="subtitle">Inventario ‚Ä¢ Orde√±o ‚Ä¢ Sanidad ‚Ä¢ Reproducci√≥n ‚Ä¢ Finanzas ‚Ä¢ Alertas</div>
      </div>
    </div>

    <div class="userbox">
      <label class="label">Usuario</label>
      <select id="userSelect"></select>
      <button id="addUserBtn" class="btn secondary">+ Usuario</button>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab active" data-tab="dashboard">Panel</button>
    <button class="tab" data-tab="animals">Animales</button>
    <button class="tab" data-tab="milk">Orde√±o</button>
    <button class="tab" data-tab="health">Sanidad</button>
    <button class="tab" data-tab="repro">Reproducci√≥n</button>
    <button class="tab" data-tab="finance">Finanzas</button>
  </nav>

  <main class="container">
    <section class="view" id="view-dashboard">
      <section class="grid">
        <div class="card">
          <div class="card-h">Alertas</div>
          <div class="alert-grid">
            <div class="metric"><div class="metric-k">Refuerzos vencidos</div><div class="metric-v" id="mOverdue">0</div></div>
            <div class="metric"><div class="metric-k">Refuerzos ‚â§ 3 d√≠as</div><div class="metric-v" id="mD3">0</div></div>
            <div class="metric"><div class="metric-k">Refuerzos ‚â§ 10 d√≠as</div><div class="metric-v" id="mD10">0</div></div>
            <div class="metric"><div class="metric-k">Refuerzos ‚â§ 15 d√≠as</div><div class="metric-v" id="mD15">0</div></div>
            <div class="metric"><div class="metric-k">Producci√≥n baja (&lt;4L) √∫ltimos 7 d√≠as</div><div class="metric-v" id="mLowMilk">0</div></div>
            <div class="metric"><div class="metric-k">Repro ‚ÄúREVISAR‚Äù (&gt;120 d√≠as)</div><div class="metric-v" id="mRepro">0</div></div>
          </div>
          <div class="divider"></div>
          <div class="list" id="alertsList"></div>
        </div>

        <div class="card">
          <div class="card-h">Acciones r√°pidas</div>
          <div class="actions">
            <button class="btn" id="quickMilk">+ Orde√±o</button>
            <button class="btn" id="quickMeds">+ Medicamento</button>
            <button class="btn" id="quickHealth">+ Sanidad</button>
            <button class="btn" id="quickRepro">+ Reproducci√≥n</button>
            <button class="btn secondary" id="exportBtn">Exportar respaldo (JSON)</button>
            <label class="btn secondary filebtn">
              Importar respaldo (JSON)
              <input type="file" id="importFile" accept="application/json" />
            </label>

            <label class="btn secondary filebtn">
              Importar desde Excel (XLSX)
              <input type="file" id="importExcelFile" accept=".xlsx" />
            </label>

          </div>
          <div class="divider"></div>
          <div class="small">‚úÖ Offline ‚Ä¢ üì± Instalable ‚Ä¢ üë§ Multiusuario local</div>
        </div>
      </section>

      <section class="card">
        <div class="card-h">Ranking de vacas (√∫ltimos 30 d√≠as)</div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Vaca</th><th>Litros (30d)</th><th>Promedio/d√≠a</th></tr></thead>
            <tbody id="rankTbody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="view hidden" id="view-animals">
      <section class="card">
        <div class="card-h">Inventario de animales</div>
        <div class="filters">
          <button class="btn secondary" id="quickRowAnimals">+ Fila r√°pida</button>
          <button class="btn" id="addAnimalBtn">+ Agregar animal</button>
          <input id="searchAnimals" placeholder="Buscar por arete o nombre..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Finca</th><th>Nombre/Arete</th><th>Arete</th><th>Sexo</th><th>Edad (texto)</th><th>Peso (texto)</th><th>Peso (kg)</th><th>Raza</th><th>Fecha Nac.</th><th>Anotaciones</th><th>Edad (a√±os)</th><th></th></tr></thead>
            <tbody id="animalsTbody"></tbody>
          </table>
        </div>
      
    </section>

    <section class="view hidden" id="view-brutos">
      <section class="card">
        <div class="card-h">Bovinos Brutos</div>
        <div class="filters">
          <button class="btn secondary" id="quickRowBrutos">+ Fila r√°pida</button>
          <button class="btn" id="addBrutoBtn">+ Agregar</button>
          <input id="searchBrutos" placeholder="Buscar por arete o nombre..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead>
              <tr>
                <th>Estado/Nota</th><th>Finca</th><th>Nombre/Arete</th><th>Arete</th><th>Sexo</th><th>Edad</th><th>Peso</th><th>Raza</th><th>Fecha Nac.</th><th>Anotaciones</th><th></th>
              </tr>
            </thead>
            <tbody id="brutosTbody"></tbody>
          </table>
        </div>
      </section>
    

    
    <section class="view hidden" id="view-meds">
      <section class="card">
        <div class="card-h">Medicamentos / Procedimientos</div>
        <div class="filters">
          <button class="btn secondary" id="quickRowMeds">+ Fila r√°pida</button>
          <button class="btn" id="addMedBtn">+ Registrar</button>
          <input id="searchMeds" placeholder="Buscar por finca, nombre o procedimiento..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead>
              <tr>
                <th>Finca</th><th>Nombre</th><th>Sexo</th><th>Fecha</th><th>Medicamento/Procedimiento</th><th>Responsable</th><th>Plan</th><th>Costo (COP)</th><th>Notas</th><th></th>
              </tr>
            </thead>
            <tbody id="medsTbody"></tbody>
          </table>
        </div>
        <div class="divider"></div>
        <div class="small">üí° Si en ‚ÄúPlan‚Äù escribes fechas (ej: refuerzo 10/03/2026) el sistema crea refuerzos autom√°ticamente.</div>
      </section>
    </section>

<section class="view hidden" id="view-milk">
      <section class="card">
        <div class="card-h">Registro de orde√±o (por vaca)</div>
        <div class="filters">
          <button class="btn" id="addMilkBtn">+ Registrar orde√±o</button>
          <input id="searchMilk" placeholder="Buscar por arete o nombre..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Fecha</th><th>Vaca</th><th>Ma√±ana</th><th>Tarde</th><th>Total</th><th>Usuario</th><th></th></tr></thead>
            <tbody id="milkTbody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="view hidden" id="view-health">
      <section class="card">
        <div class="card-h">Sanidad + refuerzos</div>
        <div class="filters">
          <button class="btn" id="addHealthBtn">+ Registrar sanidad</button>
          <select id="filterBoosters">
            <option value="all">Refuerzos: todos</option>
            <option value="overdue">Vencidos</option>
            <option value="d3">‚â§ 3 d√≠as</option>
            <option value="d10">‚â§ 10 d√≠as</option>
            <option value="d15">‚â§ 15 d√≠as</option>
            <option value="ok">OK</option>
            <option value="done">Hechos</option>
          </select>
          <input id="searchBoosters" placeholder="Buscar por arete o nombre..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Animal</th><th>Procedimiento</th><th>Refuerzo</th><th>Estado</th><th>Creado por</th><th></th></tr></thead>
            <tbody id="boostersTbody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="view hidden" id="view-repro">
      <section class="card">
        <div class="card-h">Reproducci√≥n</div>
        <div class="filters">
          <button class="btn" id="addReproBtn">+ Registrar repro</button>
          <select id="filterRepro">
            <option value="all">Todas</option>
            <option value="revisar">Solo REVISAR (&gt;120 d√≠as)</option>
          </select>
          <input id="searchRepro" placeholder="Buscar por arete o nombre..." />
        </div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Vaca</th><th>√öltimo parto</th><th>√öltimo celo</th><th>Inseminaci√≥n</th><th>Pre√±ez</th><th>D√≠as abiertos</th><th>Alerta</th><th></th></tr></thead>
            <tbody id="reproTbody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="view hidden" id="view-finance">
      <section class="grid">
        <div class="card">
          <div class="card-h">Ventas de queso</div>
          <div class="filters"><button class="btn" id="addSaleBtn">+ Venta</button></div>
          <div class="tablewrap">
            <table>
              <thead><tr><th>Fecha</th><th>Cliente</th><th>Libras</th><th>Precio</th><th>Total</th><th></th></tr></thead>
              <tbody id="salesTbody"></tbody>
            </table>
          </div>
        </div>
        <div class="card">
          <div class="card-h">Compras / Transportes / Gastos fijos</div>
          <div class="actions">
            <button class="btn" id="addBuyMilkBtn">+ Compra leche</button>
            <button class="btn" id="addTransMilkBtn">+ Transporte leche</button>
            <button class="btn" id="addFixedBtn">+ Gasto fijo</button>
          </div>
          <div class="divider"></div>
          <div class="list" id="financeSummary"></div>
        </div>
      </section>

      <section class="card">
        <div class="card-h">Registros financieros</div>
        <div class="tablewrap">
          <table>
            <thead><tr><th>Tipo</th><th>Periodo</th><th>Detalle</th><th>Total</th><th></th></tr></thead>
            <tbody id="financeTbody"></tbody>
          </table>
        </div>
      </section>
    </section>
  </main>

  <div class="modal" id="modal">
    <div class="modal-card">
      <div class="modal-h">
        <div id="modalTitle">Formulario</div>
        <button class="iconbtn" id="closeModal">‚úï</button>
      </div>
      <div class="modal-b" id="modalBody"></div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('sw.js'));
    }
  </script>
</body>
</html>
